# STM32课程代码构建规划

## 当前进度
- 基础技能 (lesson_2-1, 3-1~3-5) ✓
- 传感器与输入 (lesson_4-1, 5-1~5-2) ✓
- **当前进度：lesson_5-2 (旋转编码器计次)**

---

## 后续课程规划

### 第6章：定时器 (Timer)
| 课程 | 主题 | 需要模块 | 难度 |
|------|------|----------|------|
| 6-1 | 定时器定时中断 | Timer | ★☆☆ |
| 6-2 | 定时器外部时钟 | Timer | ★☆☆ |
| 6-3 | PWM驱动LED呼吸灯 | PWM, LED | ★★☆ |
| 6-4 | PWM驱动舵机 | PWM, Servo | ★★☆ |
| 6-5 | PWM驱动直流电机 | PWM, Motor | ★★☆ |
| 6-6 | 输入捕获模式测频率 | IC, Timer | ★★★ |
| 6-7 | PWMI模式测频率占空比 | IC, Timer | ★★★ |
| 6-8 | 编码器接口测速 | Encoder | ★★☆ |

### 第7章：ADC模数转换
| 课程 | 主题 | 需要模块 | 难度 |
|------|------|----------|------|
| 7-1 | AD单通道 | ADC | ★☆☆ |
| 7-2 | AD多通道 | ADC | ★★☆ |

### 第8章：DMA直接存储器访问
| 课程 | 主题 | 需要模块 | 难度 |
|------|------|----------|------|
| 8-1 | DMA数据转运 | DMA | ★★☆ |
| 8-2 | DMA+AD多通道 | DMA, ADC | ★★★ |

### 第9章：串口通信
| 课程 | 主题 | 需要模块 | 难度 |
|------|------|----------|------|
| 9-1 | 串口发送 | USART | ★☆☆ |
| 9-2 | 串口发送+接收 | USART | ★☆☆ |
| 9-3 | 串口收发HEX数据包 | USART, Protocol | ★★☆ |
| 9-4 | 串口收发文本数据包 | USART, Protocol | ★★☆ |

### 第10章：I2C通信
| 课程 | 主题 | 需要模块 | 难度 |
|------|------|----------|------|
| 10-1 | 软件I2C读写MPU6050 | MyI2C, MPU6050 | ★★★ |
| 10-2 | 硬件I2C读写MPU6050 | MPU6050 | ★★★ |

### 第11章：SPI通信
| 课程 | 主题 | 需要模块 | 难度 |
|------|------|----------|------|
| 11-1 | 软件SPI读写W25Q64 | MySPI, W25Q64 | ★★★ |
| 11-2 | 硬件SPI读写W25Q64 | W25Q64 | ★★★ |

### 第12章：备份寄存器与RTC
| 课程 | 主题 | 需要模块 | 难度 |
|------|------|----------|------|
| 12-1 | 读写备份寄存器 | BKP | ★★☆ |
| 12-2 | 实时时钟 | RTC | ★★★ |

### 第13章：低功耗模式
| 课程 | 主题 | 需要模块 | 难度 |
|------|------|----------|------|
| 13-1 | 修改主频 | RCC | ★★☆ |
| 13-2 | 睡眠模式+串口收发 | PWR, USART | ★★☆ |
| 13-3 | 停止模式+对射红外 | PWR, EXTI | ★★★ |
| 13-4 | 待机模式+实时时钟 | PWR, RTC | ★★★ |

### 第14章：看门狗
| 课程 | 主题 | 需要模块 | 难度 |
|------|------|----------|------|
| 14-1 | 独立看门狗 | IWDG | ★★☆ |
| 14-2 | 窗口看门狗 | WWDG | ★★☆ |

### 第15章：内部FLASH
| 课程 | 主题 | 需要模块 | 难度 |
|------|------|----------|------|
| 15-1 | 读写内部FLASH | FLASH | ★★★ |
| 15-2 | 读取芯片ID | - | ★☆☆ |

---

## 模块复用策略

### 通用模块 (每个lesson都要用)
- Delay.c/h (延时函数)
- OLED.c/h (显示)
- stm32f10x_conf.h (外设配置)

### 专用模块 (按需添加)
| 模块 | 课程 | 说明 |
|------|------|------|
| Key.c/h | 3-4, 6-4, 10-1~11-2 | 按键检测 |
| LED.c/h | 3-1~3-4, 6-3, 10-1~11-2 | LED控制 |
| Encoder.c/h | 5-2, 6-8 | 编码器接口 |
| MyI2C.c/h | 10-1 | 软件I2C |
| MPU6050.c/h | 10-1~10-2 | 姿态传感器 |
| MySPI.c/h | 11-1 | 软件SPI |
| W25Q64.c/h | 11-1~11-2 | 外部Flash |

---

## 构建命令速查

```bash
# 配置 (首次或切换程序)
cmake -S . -B build \
    -DCMAKE_TOOLCHAIN_FILE=cmake/toolchains/arm-gcc.cmake \
    -DBOARD=stm32f103c8t6 \
    -DAPP=<lesson_name> \
    -G Ninja

# 构建
cmake --build build

# 烧录
openocd -f boards/stm32f103c8t6/openocd.cfg \
    -c "program build/firmware.elf verify reset exit"
```

---

## 建议

1. **lesson_6-1~6-5** 可以合并为一个项目 (定时器+PWM综合)
2. **lesson_7-8** (ADC+DMA) 可以合并
3. **lesson_9** (串口) 可以合并为一个项目
4. **lesson_10-11** (I2C+SPI) 可以合并为传感器/存储综合
5. **lesson_12-15** 可以合并为系统功能综合

每个chapter的lesson共享硬件模块，只替换main.c即可。

---

## 课程源码位置
`/home/muqiao/dev/embedded/stm32/learning/课件/程序源码/程序源码/STM32Project-有注释版/`
